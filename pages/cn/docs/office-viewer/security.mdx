# 水印与密码配置

本文介绍如何为文档添加水印以及在加载受保护文档时进行密码校验。

## 水印（`watermark`）

通过 `props.watermark` 可配置文档水印。水印会覆盖在页面画布上，参数如下：

- `text`（String，默认：无）
- `columns`（Number，默认：`4`，正整数）
- `rows`（Number，默认：`4`，正整数）
- `color`（String，默认：`rgba(0, 0, 0, 0.2)`）
- `rotation`（Number，默认：`30`，正整数）
- `fontSize`（Number，默认：`12 * window.devicePixelRatio`，正整数）

示例：

```js
const options = ref({
  title: '测试文档.pdf',
  source: '/demo.pdf',
  watermark: {
    text: 'Umo Office Viewer',
    columns: 3,
    rows: 3,
    color: 'rgba(0, 0, 0, 0.1)',
    rotation: 25,
  },
})
```

## 密码保护（`needPassword` / `onValidatePassword`）

当预览受保护的文档时，组件引导用户输入密码并进行验证：

- `needPassword`（Boolean）：强制展示密码输入界面（或在检测到受保护文档时自动进入）
- `onValidatePassword(password: string) => boolean | Promise<boolean>`：用于校验用户输入的密码；返回 `true` 视为通过

工作流程（简化说明）：

- 文档加载阶段若检测到需要密码，组件会设置 `state.needPassword = true`，并等待用户输入
- 你配置 `onValidatePassword` 进行校验
- 当校验通过时，库会使用该密码继续加载文档；加载完成后触发 `loaded` 事件

示例：

```ts
const options = ref({
  title: '受保护文档.pdf',
  source: '/demo_protected.pdf',
  needPassword: true,
  onValidatePassword: (password) => password === '1234',
})
```

> 提示：密码不应在前端硬编码；建议将验证逻辑放在后端并结合会话或令牌校验，前端仅作为输入中转与提示。
