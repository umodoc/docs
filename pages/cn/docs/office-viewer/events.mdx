import { Badge } from '/components/badge'

# 事件列表

本节将介绍 Umo Office Viewer 的事件，通过事件可以监听 Umo Office Viewer 的完整生命周期以及状态的变化，进行更多操作。

## 示例

```vue {4-13}
<template>
  <umo-office-viewer
    v-bind="options"
    @loaded="onLoaded"
    @closed="onClosed"
    @aside-change="onAsideChange"
    @page-change="onPageChange"
    @rotate-change="onRotateChange"
    @scale-change="onScaleChange"
    @fullscreen-change="onFullscreenChange"
    @download="onDownload"
    @export="onExport"
    @print="onPrint"
  />
</template>
 
<script setup>
  import { ref } from 'vue';
  import { UmoOfficeViewer } from '@umoteam/office-viewer';

  const options = ref({
    // 配置项
    // ...
  });

  const onLoaded = () => {
    console.log('onLoaded', '文档加载完成')
  }
  const onClosed = () => {
    console.log('onClosed', '点击了关闭按钮')
  }
  const onAsideChange = (aside: 'info' | 'thumbs') => {
    console.log('onAsideChange', '开启侧边栏并切换面板:', { aside })
  }
  const onPageChange = (activePage: number) => {
    console.log('onPageChange', '当前页码变化:', { activePage })
  }
  const onRotateChange = (rotate: number) => {
    console.log('onRotateChange', '旋转角度发生变化:', { rotate })
  }
  const onScaleChange = (scale: number) => {
    console.log('onScaleChange', '缩放比例变化:', {scale})
  }
  const onFullscreenChange = (fullscreen: boolean) => {
    console.log('onFullscreenChange', '全屏状态发生变化:',  { fullscreen })
  }
  const onDownload = () => {
    console.log('onDownload', '下载文档')
  }
  const onPrint = () => {
    console.log('onPrint', '打印文档')
  }
  const onExport = () => {
    console.log('onExport', '导出文档')
  }
</script>
```

## 事件说明

| 事件名称 | 触发时机 / 说明 | 可用参数 |
| --- | --- | --- |
| loaded | 文档加载完成 | - |
| closed | 点击标题栏关闭按钮并执行 `onClose()` 后 | - |
| aside-change | 开启侧边栏并切换面板 | aside |
| page-change | 当前页码变化（滚动或方法 `gotoPage`） | activePage |
| rotate-change | 页面旋转角度变化 | rotate |
| scale-change | 页面缩放比例变化 | scale |
| fullscreen-change | 组件全屏状态切换  | fullscreen |
| download | 下载文档  | - |
| export | 导出文档  | - |
| print | 打印文档  | - |
